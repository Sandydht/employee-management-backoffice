<table class="w-full h-auto relative">
  <thead class="w-auto h-auto bg-gray-100 sticky top-0 z-10 border-b border-gray-100 shadow-md">
    <tr>
      @for (col of columns(); track col.key) {
        <th
          class="w-auto h-auto px-4 py-3 text-left text-[14px] leading-[20px] font-semibold whitespace-nowrap"
          [ngClass]="{
            'cursor-pointer select-none': col.sortable,
          }"
          (click)="handleSort(col)"
        >
          {{ col.header }}

          @if (col.sortable) {
            <span
              class="transition-opacity text-[12px] leading-[16px]"
              [ngClass]="{
                'opacity-100': isActiveSort(col),
                'opacity-40': !isActiveSort(col),
              }"
            >
              @if (isActiveSort(col)) {
                {{ sort().direction === 'asc' ? '▲' : '▼' }}
              } @else {
                ▲▼
              }
            </span>
          }
        </th>
      }
    </tr>
  </thead>

  @if (loading()) {
    <tbody>
      <tr>
        <td
          [attr.colspan]="colSpan"
          class="w-auto h-auto px-4 py-6 text-center text-[14px] leading-[20px] font-semibold whitespace-nowrap"
        >
          Loading data...
        </td>
      </tr>
    </tbody>
  } @else if (!loading() && datas().length === 0) {
    <tbody>
      <tr>
        <td
          [attr.colspan]="colSpan"
          class="w-auto h-auto px-4 py-6 text-center text-[14px] leading-[20px] font-semibold whitespace-nowrap"
        >
          {{ emptyText() }}
        </td>
      </tr>
    </tbody>
  } @else {
    <tbody>
      @for (row of datas(); track trackRow($index, row)) {
        <tr>
          @for (col of columns(); track col.key) {
            <td
              class="w-auto h-auto px-4 py-3 text-left text-[14px] leading-[20px] border-b border-gray-300 whitespace-nowrap"
            >
              @if (col.template) {
                <ng-container
                  *ngTemplateOutlet="col.template; context: { $implicit: row }"
                ></ng-container>
              } @else {
                {{ getCellValue(row, col) }}
              }
            </td>
          }
        </tr>
      }
    </tbody>
  }
</table>
